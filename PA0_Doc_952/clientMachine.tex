
\subsection{کارخواه}
برنامه‌ی شما در نقش کارخواه وظایفی دارید که به شرح زیر است:
\begin{itemize}
\item
مسیریابی بسته‌ها

به طور کلی شما وظیفه دارید تمام بسته‌هایی را که دریافت می‌کنید، در صورتی که این بسته متعلق به شما نیست، روی تمام واسط‌هایتان (به‌جز واسطی که بسته از آن آمده) بسته را broadcast کنید.

\item
دریافت دستور 
\begin{flushleft}
\code{get ip}
\end{flushleft}
از کاربر.

هنگامی که کاربر این دستور را وارد کرد، شما وظیفه دارید تا یک IP جدید برای کاربر درخواست کنید (ارسال بسته‌ی 
\lr{DHCPDISCOVER}
)
فرآیند درخواست به این صورت است که شما بسته درخواست را روی تمام واسط های خود می‌فرستید. حال باید منتظر بمانید تا کارگزاری به درخواست شما با بسته
\lr{DHCPOFFER}
پاسخ دهد.

\item
دریافت بسته
\lr{DHCPOFFER}

هنگامی که این بسته را دریافت کردید، در صورتی که این بسته متعلق به شما بود آن را ذخیره کنید. سپس در خروجی پیام 
\begin{flushleft}
\code{new offer: $X$} 
\end{flushleft}
که در اینجا $X$ در واقع همان آدرس پیشنهاد شده به شماست.

\item
دریافت دستور 
\begin{flushleft}
\code{accept offer: $X$} 
\end{flushleft}
از ورودی که $X$ یکی از آدرس‌های پیشنهادی است.

در صورتی که پیشنهادی با آدرس درخواستی برای شما نیامده بود پیام
\begin{flushleft}
\code{invalid offer}
\end{flushleft}
را چاپ کنید. در غیر این صورت، بر روی تمام واسط‌های خود بسته 
\lr{DHCPREQUEST}
را ارسال کنید.

\item
دریافت بسته
\lr{DHCPACK}

در این زمان درخواست شما تایید شده و در نتیجه شما IP درخواستی خود را دریافت کرده‌اید. پس پیام 
\begin{flushleft}
\code{now my ip is: $X$}
\end{flushleft}
که $X$ آدرس دریافتی است، را چاپ کنید.

\item
دریافت دستور 
\begin{flushleft}
\code{release $X$}
\end{flushleft}

اگر از قبل آی‌پیِ $X$ را گرفته بودید، پس از دریافت این دستور، بسته‌ای از جنس
\lr{DHCPRELEASE}
تولید کنید و آن را روی تمام واسط‌های خود بفرستید.
همچنین عبارت
\begin{flushleft}
\code{ip released}
\end{flushleft}
را در خروجی چاپ کنید و فرض کنید دیگر IP شما وجود ندارد.

\notice{
اگر از قبل آی‌پی $X$ را نگرفته بودید، نیازی نیست کاری انجام دهید یا چیزی چاپ کنید.
}

\item
دریافت بسته 
\lr{DHCPTIMEOUT}

این بسته نشان‌دهنده این است که آی‌پی شما دیگر اعتباری ندارد، در نتیجه عبارت
\begin{flushleft}
\code{ip released}
\end{flushleft}
را چاپ کنید.

\item
دریافت دستور
\begin{flushleft}
\code{extend lease}
\end{flushleft}
 به این معنی که زمان منقضی شدن را 10 واحد افزایش دهید.

پس از دریافت این دستور، باید بسته‌ای از نوع
\lr{Request ٍExtend}
تولید کنید و روی تمام واسط‌های خود بفرستید.

\item
 دریافت بسته
\lr{Response Extend}

این پیام به این معنی است که با درخواست تمدید شما موافقت شده است و می‌توانید از آی‌پی جدیدی که در این بسته برای تمدید به شما داده شده استفاده کنید. دقت کنید که آی‌پی قبلی شما نامعتبر شده است. پس در خروجی عبارت
\begin{flushleft}
\code{now my ip is: $X$}
\end{flushleft}
که $X$ آدرس جدید است را چاپ کنید.

\item
دریافت دستور
\begin{flushleft}
\code{print ip}
\end{flushleft}

در این صورت باید تمام IP هایی که در حال حاضر متعلق به این گره هستند را به ترتیب از کوچک به بزرگ، هر کدام را در یک خط جدا چاپ کنید.
\end{itemize}
